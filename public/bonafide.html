<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Bonafide</title>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <link rel="shortcut icon" href="../src/assets/GM.png" type="image/x-icon" />
    <link
      href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css"
      rel="stylesheet"
    />

    <style>
      @font-face {
        font-family: eklg;
        src: url("EKLG-13B.TTF");
      }
      input {
        border: 0;
        outline: 0;
      }
      input:focus {
        outline: none !important;
      }
      .eklg {
        font-family: eklg;
      }

      p {
        text-indent: 75px;
      }
    </style>
  </head>
  <body>
    <div
      class="box-content md:w-9/12 w-full p-4 mx-auto container justify-center my-8"
    >
      <section
        class="text-gray-600 body-font border-solid border-b-2 border-black pb-1"
      >
        <div
          class="container mx-auto flex md:px-6 py-1 md:flex-row flex-col items-center border-dotted border-b-2 border-black"
        >
          <!-- <title class="hidden">School Logo</title> -->
          <div class="flex justify-between w-full">
            <div class="md:mb-3 mb-3 relative md:left-14 -left-6">
              <div class="md:h-40 md:w-40 h-36 w-36">
                <img
                  class="object-cover object-center rounded w-full h-full"
                  alt="Logo"
                  src="/src/assets/GM.png"
                />
              </div>
            </div>
            <!-- <title class="hidden">School Title</title> -->
            <div class="relative w-full top-4">
              <h1
                class="title-font sm:text-xl text-center text-xl mb-1 font-medium text-gray-900 eklg"
              >
                tt `enrh tt
              </h1>
              <h1
                class="title-font lg:text-5xl md:text-3xl sm:text-3xl text-4xl mb-1 font-medium text-gray-900 eklg"
              >
                <input
                  type="text"
                  class="title-font lg:text-5xl md:text-3xl sm:text-3xl text-4xl mb-1 font-medium text-gray-900 eklg w-full text-center bg-transparent"
                  value="`e lgttjtfhKt mt'TrJt$t btkr'h vt{t. NttGt"
                  style="
                    border: none;
                    outline: none;
                    width: 100%;
                    min-width: 100%;
                    box-sizing: border-box;
                  "
                />
              </h1>
              <h1
                class="title-font sm:text-xl text-xl text-center mb-4 font-medium text-gray-900 eklg"
              >
                bttkzJt"tth,;tt.dtZzt (mJtt.), B.cttuxt'.
              </h1>
            </div>
          </div>
        </div>
      </section>
      <!-- <title class="hidden"> Date and GRNO</title> -->
      <section class="lg:px-28 md:px-24 sm:px-8 px-8 my-6">
        <h1 class="inline-flex font-bold">
          જ.નં - &nbsp;<span class=""
            ><input
              type="text"
              id="grno"
              class="inline-flex font-bold"
              value="11111"
          /></span>
        </h1>
        <h1 class="float-right font-bold">
          તારીખ - &nbsp;<span
            ><input
              type="text"
              id="today_date"
              style="width: 100px"
              class="inline-flex font-bold"
              value="26-02-2002"
            />
          </span>
        </h1>
      </section>
      <!-- <title class="hidden">Student Details</title> -->
      <section class="text-black body-font">
        <div class="container px-7 py-24 mx-auto">
          <!-- <title class="hidden">bonofide</title> -->
          <section class="mb-6">
            <h1 class="text-center font-bold underline text-xl">
              બોનાફાઈડ પ્રમાણપત્ર
            </h1>
          </section>
          <div class="flex flex-col text-justify w-full mb-10">
            <p
              class="md:w-10/12 mx-auto leading-relaxed text-xl font-semibold justify-center items-center"
            >
              આથી લખી આપવામાં આવે છે કે
              <span class="underline" id="gender">શ્રી</span>
              <input
                type="text"
                id="name"
                value="STUDENT NAME FULL ABC"
                class="underline font-bold"
              />
              આ શાળામાં હાલ ધોરણ-<input
                type="text"
                value="9"
                class="underline text-center w-10"
              />માં અભ્યાસ <span id="status">કરે છે</span>. અમારી શાળાના
              જી.આર.નં-
              <span class="underline" id="grno_input">11111</span> પ્રમાણે તેમની
              જન્મ તારીખ-
              <span class="underline" id="birth_date">01-01-2001</span> અને અને
              શબ્દોમાં
              <span class="underline" id="birth_date_words"
                >અઢારમી-જુલાઈ-બે હજાર પંદર</span
              >
              છે. તેની જાતી
              <span class="underline" id="jati">હિન્દુ લેઉવા કણબી</span> છે. જે
              ખાત્રી બદલ આ પ્રમાણપત્ર લખી આપવામાં આવે છે.
            </p>
          </div>
        </div>
      </section>
      <!-- <title class="hidden">Principal sign</title> -->
      <section class="lg:px-28 md:px-24 sm:px-8 px-8 mt-4 mb-24">
        <h1 class="float-right font-bold px-24">આચાર્ય શ્રી.</h1>
      </section>
    </div>
  </body>
  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const id = urlParams.get("id");
    const baseUrl = "https://school-management-be-2.onrender.com";
    function convertToGujaratiWords(date) {
      const gujaratiNumbers = {
        1: "એક",
        2: "બે",
        3: "ત્રણ",
        4: "ચાર",
        5: "પાંચ",
        6: "છ",
        7: "સાત",
        8: "આઠ",
        9: "નવ",
        10: "દસ",
        11: "અગિયાર",
        12: "બાર",
        13: "તેર",
        14: "ચૌદ",
        15: "પંદર",
        16: "સોળ",
        17: "સત્તર",
        18: "અઢાર",
        19: "ઓગણીસ",
        20: "વીસ",
        21: "એકવીસ",
        22: "બાવીસ",
        23: "ત્રેવીસ",
        24: "ચોવીસ",
        25: "પચ્ચીસ",
        26: "છવ્વીસ",
        27: "સત્તાવીસ",
        28: "અઠ્ઠાવીસ",
        29: "ઓગણત્રીસ",
        30: "ત્રીસ",
        31: "એકત્રીસ",
      };

      const gujaratiMonths = {
        1: "જાન્યુઆરી",
        2: "ફેબ્રુઆરી",
        3: "માર્ચ",
        4: "એપ્રિલ",
        5: "મે",
        6: "જૂન",
        7: "જુલાઈ",
        8: "ઓગસ્ટ",
        9: "સપ્ટેમ્બર",
        10: "ઓક્ટોબર",
        11: "નવેમ્બર",
        12: "ડિસેમ્બર",
      };

      const day = date.getDate();
      const month = date.getMonth() + 1;
      const year = date.getFullYear();

      // Convert year to words
      const yearInWords = "બે હજાર " + gujaratiNumbers[year - 2000];

      return `${gujaratiNumbers[day]}મી-${gujaratiMonths[month]}-${yearInWords}`;
    }
    async function fetchCertificateData() {
      try {
        const tokenData = JSON.parse(localStorage.getItem("jwt_token"));
        const accessToken = tokenData.access;

        const response = await fetch(`${baseUrl}/students/${id}/search/`, {
          headers: {
            Authorization: `Bearer ${accessToken}`,
          },
        });
        const responseData = await response.json();
        const studentData = responseData.data; // Access the nested data object

        let name = (document.getElementById(
          "name"
        ).value = `${studentData.first_name} ${studentData.middle_name} ${studentData.last_name}`);

        const rawDate = new Date(studentData.birth_date);
        const formattedDate = rawDate.toLocaleDateString("en-IN", {
          day: "2-digit",
          month: "2-digit",
          year: "numeric",
        });

        let birth_date = (document.getElementById("birth_date").innerHTML =
          formattedDate);

        let grno = (document.getElementById("grno").value = studentData.grno);

        let grno_input = (document.getElementById("grno_input").innerHTML =
          studentData.grno);

        let jati = (document.getElementById(
          "jati"
        ).innerHTML = `${studentData.religion} ${studentData.caste}`);

        let birth_date_words = (document.getElementById(
          "birth_date_words"
        ).innerHTML = convertToGujaratiWords(rawDate));

        let status_info = "કરતા હતા";

        if (studentData.status === "ચાલુ") {
          status_info = "કરે છે";
        } else {
          status_info;
        }

        let status = (document.getElementById("status").innerHTML =
          status_info);

        let gender_info = "કુમાર";

        if (studentData.gender === "કન્યા") {
          gender_info = "શ્રીમતી";
        } else {
          gender_info;
        }

        let gender = (document.getElementById("gender").innerHTML =
          gender_info);

        const today = new Date();
        const day = String(today.getDate()).padStart(2, "0");
        const month = String(today.getMonth() + 1).padStart(2, "0");
        const year = today.getFullYear();
        const date_today = `${day}-${month}-${year}`;

        let today_date = (document.getElementById("today_date").value =
          date_today);

        return studentData;
      } catch (error) {
        console.error("Error fetching certificate data:", error);
      }
    }

    if (id && !isNaN(id)) {
      fetchCertificateData();
    }
  </script>
</html>
